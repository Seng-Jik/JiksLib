# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a Unity 2022.3.62f2 project with a custom C# library called **JiksLib**. The project has a dual architecture:
1. **Unity Game Project** - Standard Unity project structure
2. **JiksLib.Core** - A .NET library built as a DLL and imported into Unity

The library provides essential utilities and functionalities for Unity projects, with components that can be used independently of Unity.

## Architecture

### Core Library Structure
- **JiksLib.Core/** - Main library project (multi-targets: net48, net10.0, netstandard2.1)
- **JiksLib.Core.Test/** - Unit tests using NUnit
- **Assets/JiksLib/** - Unity package containing the built DLL and UniTask integration

### Key Components
1. **Collections** - Custom collection types (Deque, MultiDictionary, MultiHashSet, Cell/OnceCell, Range types)
2. **Control** - Disposable pattern utilities, UnitType
3. **Extensions** - AsReadOnlyExtension, AnythingExtension
4. **Text** - CSV reader/writer utilities

### Unity Integration
- Library is built as a DLL (`JiksLib.Core.dll`) and placed in `Assets/JiksLib/`
- UniTask support via separate assembly (`JiksLib.UniTask.asmdef`)
- Conditional compilation symbol: `JIKS_LIB_ENABLE_UNITASK` for UniTask features

## Development Commands

### Building the Library
```powershell
# From JiksLib.Core directory
.\build.ps1
```
This script:
1. Builds the library with `dotnet publish -c Release -f net48`
2. Copies the DLL to `../Assets/JiksLib/JiksLib.Core.dll`

### Running Tests
```bash
# From JiksLib.Core.Test directory
dotnet test
```
- Tests require .NET SDK 10 or higher
- Uses NUnit framework
- Multi-targets: net10.0 and net48

### Development Environment
- Primary IDE: VS Code (configured in `.vscode/settings.json`)
- Default solution: `JiksLib.sln`
- VS Code excludes Unity-generated files (Library/, Temp/, etc.)

## Project Structure Notes

### Unity-Generated Files
- Numerous `.csproj` files are auto-generated by Unity for each module
- These should generally be ignored during development
- VS Code is configured to exclude Unity cache directories

### Package Management
- Unity packages managed via `Packages/manifest.json`
- External dependencies include UniTask, URP, and various Unity modules
- JiksLib package metadata in `Assets/JiksLib/package.json`

## Important Considerations

1. **Multi-targeting**: Library supports .NET Framework 4.8 (Unity compatibility) and newer .NET versions
2. **Nullable Reference Types**: Enabled throughout the codebase (`#nullable enable`)
3. **DLL Distribution**: Library distributed as compiled DLL to Unity projects
4. **Separation of Concerns**: Core logic is independent of Unity-specific code

## Common Workflows

### Adding New Features to JiksLib.Core
1. Implement feature in `JiksLib.Core/` directory
2. Add corresponding tests in `JiksLib.Core.Test/`
3. Run `dotnet test` to verify
4. Run `.\build.ps1` to update the Unity DLL
5. Test in Unity project

### Updating Unity Integration
- Modify `Assets/JiksLib/package.json` for package metadata
- Update `Assets/JiksLib/JiksLib.UniTask/` for UniTask integration
- Rebuild DLL after core library changes

### Testing Changes
- Unit tests cover all major components
- Test both .NET Framework 4.8 and .NET 10.0 targets
- Verify Unity compatibility after DLL updates